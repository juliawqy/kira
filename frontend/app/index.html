<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Task Manager – Modular (Light)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="wrap">
    <div class="header-bar">
      <div style="display: flex; align-items: center; justify-content: space-between;">
        <div style="display: flex; align-items: center; gap: 12px;">
          <img src="./kira_logo.png" alt="Kira Logo" style="height: 40px; width: auto;" />
        </div>
        <div style="display: flex; align-items: center; gap: 8px;">
          <span style="font-size: 14px; color: var(--sub);">Logged in as:</span>
          <div class="user-selection">
            <button class="user-btn" id="userCong" data-user-id="1">Cong</button>
            <button class="user-btn" id="userJulia" data-user-id="2">Julia</button>
          </div>
        </div>
      </div>
    </div>

    <!-- View toggle -->
    <div class="panel" style="margin-top: 12px;">
      <div class="grid two" style="gap: 20px;">
        <div class="form-field">
          <label>View</label>
          <div style="display: flex; gap: 20px; margin-top: 10px;">
            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500; cursor: pointer; color: var(--text);">
              <input type="checkbox" id="viewCalendar" checked />
              <span>Calendar</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500; cursor: pointer; color: var(--text);">
              <input type="checkbox" id="viewList" checked />
              <span>List</span>
            </label>
          </div>
        </div>
        <div class="form-field">
          <label>Calendar shows date</label>
          <select id="calDateMode">
            <option value="due" selected>Deadline (Due)</option>
            <option value="start">Start date</option>
          </select>
        </div>
      </div>
      <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); font-size: 12px; color: var(--sub); line-height: 1.5;">
        Tip: toggle Calendar and List views independently.
      </div>
    </div>

    <!-- Calendar panel -->
    <div class="panel cal-wrap sr" id="calendarPanel">
      <div class="cal-head">
        <button class="btn" id="calPrev" type="button">← Prev</button>
        <div id="calTitle" class="muted" style="font-weight:600;"></div>
        <button class="btn" id="calNext" type="button">Next →</button>
        <span class="spacer"></span>
        <button class="btn ghost" id="calToday" type="button">Today</button>
      </div>
      <div id="calendar"></div>
    </div>


    <!-- On-going Tasks list -->
    <div class="panel" style="margin-top: 12px;" id="ongoingPanel">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
        <h2 style="margin:0;">On-going Tasks</h2>
        <div style="display: flex; gap: 8px; align-items: center;">
          <select id="filterStatus" style="padding: 4px 8px; border-radius: 4px; border: 1px solid var(--border); font-size: 12px;">
            <option value="">All Status</option>
            <option value="To-do">To-do</option>
            <option value="In-progress">In-progress</option>
            <option value="Blocked">Blocked</option>
          </select>
          <select id="filterPriority" style="padding: 4px 8px; border-radius: 4px; border: 1px solid var(--border); font-size: 12px;">
            <option value="">All Priority</option>
            <option value="high">High (8-10)</option>
            <option value="medium">Medium (5-7)</option>
            <option value="low">Low (1-4)</option>
          </select>
          <select id="filterProject" style="padding: 4px 8px; border-radius: 4px; border: 1px solid var(--border); font-size: 12px;">
            <option value="">All Projects</option>
            <option value="1">Project Alpha (1)</option>
            <option value="100">Project Beta (100)</option>
            <option value="123">Project Gamma (123)</option>
          </select>
          <button class="btn-create-task" id="btnToggleCreate" type="button" title="Create Task" style="margin-left: 4px;">+</button>
        </div>
      </div>
      <div id="ongoing"></div>
    </div>

    <!-- Completed Tasks list -->
    <div class="panel" style="margin-top: 12px;" id="completedPanel">
      <h2 style="margin:0 0 12px 0;">Completed Tasks</h2>
      <div id="completed"></div>
    </div>

    <!-- Console -->
    <div class="panel" style="margin-top: 12px;">
      <h2>Console</h2>
      <div id="log" class="console mono small"></div>
    </div>
  </div>

  <!-- Create dialog -->
  <dialog id="dlgCreate">
    <form method="dialog" class="panel" style="min-width: 640px; background: var(--panel); padding: 24px;">
      <h2 style="margin-top: 0; margin-bottom: 20px;">Create Task</h2>
      <div class="grid three" id="createForm" style="gap: 16px;">
        <div class="form-field"><label>Title</label><input id="c_title" /><div class="error" id="c_title_err"></div></div>
        <div class="form-field" style="grid-column: span 2;"><label>Description</label><textarea id="c_desc" placeholder="Describe the task..."></textarea><div class="error" id="c_desc_err"></div></div>
        <div class="form-field"><label>Priority (1–10)</label><input id="c_priority" type="number" min="1" max="10" value="5" /><div class="error" id="c_priority_err"></div></div>
        <div class="form-field"><label>Start date</label><input id="c_start" type="date" placeholder="YYYY-MM-DD" /><div class="error" id="c_start_err"></div></div>
        <div class="form-field"><label>Deadline</label><input id="c_due" type="date" placeholder="YYYY-MM-DD" /><div class="error" id="c_due_err"></div></div>
        <div class="form-field">
          <label>Project</label>
          <select id="c_project">
            <option value="" disabled selected>Select a project</option>
            <option value="1">Project Alpha (1)</option>
            <option value="100">Project Beta (100)</option>
            <option value="123">Project Gamma (123)</option>
          </select>
          <div class="error" id="c_project_err"></div>
        </div>
        <div class="form-field"><label>Parent ID (create as subtask)</label><input id="c_parent" type="number" placeholder="optional" /><div class="error" id="c_parent_err"></div></div>
        <div class="form-field"><label>Tag</label><input id="c_tag" placeholder="optional" /><div class="error" id="c_tag_err"></div></div>
        <div class="form-field"><label>Recurring (days)</label><input id="c_recurring" type="number" min="0" max="365" value="0" /><div class="error" id="c_recurring_err"></div></div>
      </div>
      <div class="row" style="margin-top: 24px; border-top: 1px solid var(--border); padding-top: 16px;">
        <span class="row-right" style="display: flex; gap: 8px;">
          <button class="btn" value="cancel">Cancel</button>
          <button class="btn primary" id="btnCreate" value="default">Create</button>
        </span>
      </div>
    </form>
  </dialog>

  <!-- Edit dialog -->
  <dialog id="dlgEdit">
    <form method="dialog" class="panel" style="min-width: 640px; background: var(--panel);">
      <h2>Edit Task</h2>
      <div class="grid three">
        <div class="form-field"><label>Title</label><input id="e_title" /><div class="error" id="e_title_err"></div></div>
        <div class="form-field" style="grid-column: span 2;"><label>Description</label><textarea id="e_desc" placeholder="Describe the task..."></textarea><div class="error" id="e_desc_err"></div></div>
        <div class="form-field"><label>Priority (1–10)</label><input id="e_priority" type="number" min="1" max="10" /><div class="error" id="e_priority_err"></div></div>
        <div class="form-field"><label>Start date</label><input id="e_start" type="date" placeholder="YYYY-MM-DD"/><div class="error" id="e_start_err"></div></div>
        <div class="form-field"><label>Deadline</label><input id="e_due" type="date" placeholder="YYYY-MM-DD"/><div class="error" id="e_due_err"></div></div>
        <div class="form-field">
          <label>Project</label>
          <select id="e_project">
            <option value="" disabled selected>Select a project</option>
            <option value="1">Project Alpha (1)</option>
            <option value="100">Project Beta (100)</option>
            <option value="123">Project Gamma (123)</option>
          </select>
          <div class="error" id="e_project_err"></div>
        </div>
        <div class="form-field"><label>Tag</label><input id="e_tag" /><div class="error" id="e_tag_err"></div></div>
        <div class="form-field"><label>Recurring (days)</label><input id="e_recurring" type="number" min="0" max="365"/><div class="error" id="e_recurring_err"></div></div>
      </div>
      <div class="row" style="margin-top:10px;">
        <div class="muted small" id="e_hint"></div>
        <span class="row-right">
          <button class="btn" value="cancel">Cancel</button>
          <button class="btn success" id="btnSaveEdit" value="default">Save</button>
        </span>
      </div>
    </form>
  </dialog>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
